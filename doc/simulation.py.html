<html>
<head>
  <script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  </script>
  <script type="text/javascript" src="mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body style="font-size:1.15em">
<tt><i><font color="#9A1900">'''</font></i><br/>
<i><font color="#9A1900">Created on 14 May 2012</font></i><br/>
<br/>
<i><font color="#9A1900">@author: Matthieu Zimmer</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<br/>
<b><font color="#000080">from</font></b>&nbsp;random <b><font color="#000080">import</font></b> shuffle<br/>
<b><font color="#000080">import</font></b>&nbsp;matplotlib<font color="#990000">.</font>pyplot as plt<br/>
<b><font color="#000080">from</font></b>&nbsp;utils <b><font color="#000080">import</font></b> index_max<br/>
<b><font color="#000080">import</font></b>&nbsp;os<font color="#990000">,</font> sys<font color="#990000">,</font> time<br/>
<b><font color="#000080">from</font></b>&nbsp;mpl_toolkits<font color="#990000">.</font>mplot3d <b><font color="#000080">import</font></b> Axes3D as ax<br/>
<b><font color="#000080">import</font></b>&nbsp;representation as rpr<br/>
<br/>
<b><font color="#0000FF">class</font></b>&nbsp;<b><font color="#000000">Simulation</font></b><font color="#990000">():</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;classdocs</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">(</font>DISCRETIZE<font color="#990000">,</font> PROTOTYPE<font color="#990000">)</font> <font color="#990000">=</font> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">__init__</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nbr_epoch<font color="#990000">,</font> width<font color="#990000">,</font> dataf<font color="#990000">,</font> nbr_network<font color="#990000">,</font> build<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples <font color="#990000">=</font> <b><font color="#000000">dataf</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>networks <font color="#990000">=</font> <font color="#990000">[{}</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_network<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots <font color="#990000">=</font> <font color="#990000">{}</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>nbr_network <font color="#990000">=</font> nbr_network<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>nbr_epoch <font color="#990000">=</font> nbr_epoch<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>width <font color="#990000">=</font> width<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> build<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_network<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>networks<font color="#990000">[</font>i<font color="#990000">][</font>k<font color="#990000">.</font>__name__<font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">k</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>ninputs<font color="#990000">,</font> self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">dgraph</font></b><font color="#990000">(</font>self<font color="#990000">,</font> glist<font color="#990000">,</font> additional<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> glist<font color="#990000">:</font> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font>k<font color="#990000">]</font> <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> additional<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>k <font color="#990000">==</font> Simulation<font color="#990000">.</font>DISCRETIZE<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize'</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#990000">[[</font><font color="#993399">0</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>nbr_epoch<font color="#990000">)]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_div'</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#990000">[[</font><font color="#993399">0</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>nbr_epoch<font color="#990000">)]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#990000">[[]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">launch</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nbr_try<font color="#990000">,</font> step_propagation<font color="#990000">,</font> step_statictics<font color="#990000">,</font> step_learn<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> epoch <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>nbr_epoch<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg_plot <font color="#990000">=</font> <font color="#990000">{}</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>plots<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg_plot<font color="#990000">[</font>k<font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> network <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>networks<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full_example <font color="#990000">=</font> <b><font color="#000000">list</font></b><font color="#990000">(</font><b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">)))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">shuffle</font></b><font color="#990000">(</font>full_example<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i_ex <b><font color="#0000FF">in</font></b> full_example<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">:</font>nbr_try<font color="#990000">]:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>lnetwork <font color="#990000">=</font> network<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>lavg_plot <font color="#990000">=</font> avg_plot<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>lepoch <font color="#990000">=</font> epoch<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">step_propagation</font></b><font color="#990000">(</font>network<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">[</font>i_ex<font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples<font color="#990000">.</font>outputs<font color="#990000">[</font>i_ex<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">step_statictics</font></b><font color="#990000">(</font>self<font color="#990000">,</font> network<font color="#990000">,</font> avg_plot<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">[</font>i_ex<font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples<font color="#990000">.</font>outputs<font color="#990000">[</font>i_ex<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">step_learn</font></b><font color="#990000">(</font>network<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">[</font>i_ex<font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>examples<font color="#990000">.</font>outputs<font color="#990000">[</font>i_ex<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> avg_plot<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font>k<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>avg_plot<font color="#990000">[</font>k<font color="#990000">]</font> <font color="#990000">/</font> <font color="#990000">(</font>nbr_try <font color="#990000">*</font> self<font color="#990000">.</font>nbr_network<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><font color="#FF0000">"[%d] %d"</font> <font color="#990000">%</font> <font color="#990000">(</font>os<font color="#990000">.</font><b><font color="#000000">getpid</font></b><font color="#990000">(),</font> epoch<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">plot</font></b><font color="#990000">(</font>self<font color="#990000">,</font> decoup<font color="#990000">,</font> init_key<font color="#990000">,</font> lplots<font color="#990000">,</font> titles<font color="#990000">,</font> linewidths<font color="#990000">,</font> more<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display_interval <font color="#990000">=</font> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font>init_key<font color="#990000">]))[::</font>decoup<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>lplots<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>lplots<font color="#990000">[</font>i<font color="#990000">]==</font><font color="#FF0000">'feedback'</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>display_interval<font color="#990000">,</font> <font color="#990000">[</font>self<font color="#990000">.</font>plots<font color="#990000">[</font>lplots<font color="#990000">[</font>i<font color="#990000">]][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> display_interval<font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label<font color="#990000">=</font>titles<font color="#990000">[</font>i<font color="#990000">],</font> linewidth<font color="#990000">=</font>linewidths<font color="#990000">[</font>i<font color="#990000">],</font> color<font color="#990000">=</font><font color="#FF0000">'red'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>display_interval<font color="#990000">,</font> <font color="#990000">[</font>self<font color="#990000">.</font>plots<font color="#990000">[</font>lplots<font color="#990000">[</font>i<font color="#990000">]][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> display_interval<font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label<font color="#990000">=</font>titles<font color="#990000">[</font>i<font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linewidth<font color="#990000">=</font>linewidths<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">more</font></b><font color="#990000">(</font>plt<font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">legend</font></b><font color="#990000">(</font>loc<font color="#990000">=</font><font color="#FF0000">'best'</font><font color="#990000">,</font> frameon<font color="#990000">=</font>False<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path <font color="#990000">=</font> <font color="#FF0000">"/tmp/pyplot.%s.%s.png"</font> <font color="#990000">%</font> <font color="#990000">(</font>sys<font color="#990000">.</font>argv<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> time<font color="#990000">.</font><b><font color="#000000">strftime</font></b><font color="#990000">(</font><font color="#FF0000">"%m-%d-%H-%M-%S"</font><font color="#990000">,</font> time<font color="#990000">.</font><b><font color="#000000">localtime</font></b><font color="#990000">()))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">savefig</font></b><font color="#990000">(</font>path<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">custom_plot</font></b><font color="#990000">(</font>self<font color="#990000">,</font> additional<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> additional<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>k <font color="#990000">==</font> Simulation<font color="#990000">.</font>DISCRETIZE<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>nbr_epoch<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_div'</font><font color="#990000">][</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <font color="#990000">!=</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize'</font><font color="#990000">][</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <font color="#990000">/=</font> <font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_div'</font><font color="#990000">][</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <font color="#990000">*</font> <font color="#990000">(</font>self<font color="#990000">.</font>nbDiscre <font color="#990000">**</font> self<font color="#990000">.</font>nbDiscre<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colors <font color="#990000">=</font> <font color="#990000">[(</font><font color="#993399">0.2</font><font color="#990000">,</font> <font color="#993399">0.8</font><font color="#990000">,</font> <font color="#993399">0.88</font><font color="#990000">),</font> <font color="#FF0000">'b'</font><font color="#990000">,</font> <font color="#FF0000">'g'</font><font color="#990000">,</font> <font color="#FF0000">'r'</font><font color="#990000">,</font> <font color="#FF0000">'c'</font><font color="#990000">,</font> <font color="#FF0000">'m'</font><font color="#990000">,</font> <font color="#FF0000">'y'</font><font color="#990000">,</font> <font color="#FF0000">'k'</font><font color="#990000">,</font> <font color="#990000">(</font><font color="#993399">0.8</font><font color="#990000">,</font> <font color="#993399">0.1</font><font color="#990000">,</font> <font color="#993399">0.8</font><font color="#990000">),</font> <font color="#990000">(</font><font color="#993399">0</font><font color="#990000">.,</font> <font color="#993399">0.2</font><font color="#990000">,</font> <font color="#993399">0.5</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig <font color="#990000">=</font> plt<font color="#990000">.</font><b><font color="#000000">figure</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax <font color="#990000">=</font> fig<font color="#990000">.</font><b><font color="#000000">add_subplot</font></b><font color="#990000">(</font><font color="#993399">111</font><font color="#990000">,</font> projection<font color="#990000">=</font><font color="#FF0000">'3d'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax<font color="#990000">.</font><b><font color="#000000">scatter</font></b><font color="#990000">([</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize'</font><font color="#990000">][</font>j<font color="#990000">][</font>k<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>j<font color="#990000">]],</font> <font color="#990000">[</font>j<font color="#990000">]</font> <font color="#990000">*</font> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>j<font color="#990000">]),</font> self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>j<font color="#990000">],</font> color<font color="#990000">=</font>colors<font color="#990000">[</font>j<font color="#990000">],</font> marker<font color="#990000">=</font><font color="#FF0000">'x'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax<font color="#990000">.</font><b><font color="#000000">set_xlabel</font></b><font color="#990000">(</font><font color="#FF0000">'DISCRETIZED VALUE'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax<font color="#990000">.</font><b><font color="#000000">set_ylabel</font></b><font color="#990000">(</font><font color="#FF0000">'SHAPE'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax<font color="#990000">.</font><b><font color="#000000">set_zlabel</font></b><font color="#990000">(</font><font color="#FF0000">'EPOCH'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path <font color="#990000">=</font> <font color="#FF0000">"/tmp/pyplot.%s.%s.png"</font> <font color="#990000">%</font> <font color="#990000">(</font>sys<font color="#990000">.</font>argv<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> time<font color="#990000">.</font><b><font color="#000000">strftime</font></b><font color="#990000">(</font><font color="#FF0000">"%m-%d-%H-%M-%S"</font><font color="#990000">,</font> time<font color="#990000">.</font><b><font color="#000000">localtime</font></b><font color="#990000">()))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">savefig</font></b><font color="#990000">(</font>path<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">title</font></b><font color="#990000">(</font><font color="#FF0000">'Discretize hidden layer'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">ylabel</font></b><font color="#990000">(</font><font color="#FF0000">'DISCRETIZED VALUE'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">xlabel</font></b><font color="#990000">(</font><font color="#FF0000">"EPOCHS"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>j<font color="#990000">],</font> <font color="#990000">[</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize'</font><font color="#990000">][</font>j<font color="#990000">][</font>k<font color="#990000">]</font> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>j<font color="#990000">]],</font> <font color="#FF0000">'.'</font><font color="#990000">,</font> color<font color="#990000">=</font>colors<font color="#990000">[</font>j<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path <font color="#990000">=</font> <font color="#FF0000">"/tmp/pyplot.%s.%s.png"</font> <font color="#990000">%</font> <font color="#990000">(</font>sys<font color="#990000">.</font>argv<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> time<font color="#990000">.</font><b><font color="#000000">strftime</font></b><font color="#990000">(</font><font color="#FF0000">"%m-%d-%H-%M-%S"</font><font color="#990000">,</font> time<font color="#990000">.</font><b><font color="#000000">localtime</font></b><font color="#990000">()))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">try</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">savefig</font></b><font color="#990000">(</font>path<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">except</font></b> ValueError<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><font color="#FF0000">'Cannot save discretize_cloud'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">try</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">except</font></b> ValueError<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><font color="#FF0000">'Cannot display discretize_cloud'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">elif</font></b><font color="#990000">(</font>k <font color="#990000">==</font> Simulation<font color="#990000">.</font>PROTOTYPE<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lplot <font color="#990000">=</font> <font color="#990000">[[</font><font color="#993399">0</font><font color="#990000">.</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>ninputs<font color="#990000">)]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> network <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>networks<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im <font color="#990000">=</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>outputs<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>ninputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lplot<font color="#990000">[</font>im<font color="#990000">][</font>j<font color="#990000">]</font> <font color="#990000">+=</font> network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font>stateOutputNeurons<font color="#990000">[</font>j<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig <font color="#990000">=</font> plt<font color="#990000">.</font><b><font color="#000000">figure</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">clf</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rpr<font color="#990000">.</font><b><font color="#000000">show_repr</font></b><font color="#990000">(</font>lplot<font color="#990000">[</font>i<font color="#990000">],</font> self<font color="#990000">.</font>width<font color="#990000">,</font> fig<font color="#990000">,</font> <font color="#993399">250</font> <font color="#990000">+</font> i<font color="#990000">,</font> i<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path <font color="#990000">=</font> <font color="#FF0000">"/tmp/pyplot.%s.%s.png"</font> <font color="#990000">%</font> <font color="#990000">(</font>sys<font color="#990000">.</font>argv<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> time<font color="#990000">.</font><b><font color="#000000">strftime</font></b><font color="#990000">(</font><font color="#FF0000">"%m-%d-%H-%M-%S"</font><font color="#990000">,</font> time<font color="#990000">.</font><b><font color="#000000">localtime</font></b><font color="#990000">()))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">savefig</font></b><font color="#990000">(</font>path<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">rms</font></b><font color="#990000">(</font>self<font color="#990000">,</font> key<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>lavg_plot<font color="#990000">[</font>key <font color="#990000">+</font> <font color="#FF0000">'_rms'</font><font color="#990000">]</font> <font color="#990000">+=</font> self<font color="#990000">.</font>lnetwork<font color="#990000">[</font>key<font color="#990000">].</font><b><font color="#000000">calc_RMS</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">err</font></b><font color="#990000">(</font>self<font color="#990000">,</font> key<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>self<font color="#990000">.</font>lnetwork<font color="#990000">[</font>key<font color="#990000">].</font>stateOutputNeurons<font color="#990000">)</font> <font color="#990000">!=</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>outputs<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>lavg_plot<font color="#990000">[</font>key <font color="#990000">+</font> <font color="#FF0000">'_err'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">perf</font></b><font color="#990000">(</font>self<font color="#990000">,</font> key<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>self<font color="#990000">.</font>lnetwork<font color="#990000">[</font>key<font color="#990000">].</font>stateOutputNeurons<font color="#990000">)</font> <font color="#990000">==</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>outputs<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>lavg_plot<font color="#990000">[</font>key <font color="#990000">+</font> <font color="#FF0000">'_perf'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">discretize</font></b><font color="#990000">(</font>self<font color="#990000">,</font> key<font color="#990000">,</font> ishape<font color="#990000">,</font> nbDiscre<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>nbDiscre <font color="#990000">=</font> nbDiscre<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">nbdis</font></b><font color="#990000">(</font>nb<font color="#990000">,</font> nbDiscretized<font color="#990000">=</font>nbDiscre<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> nbDiscretized <font color="#990000">+</font> <font color="#993399">1</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>nb <font color="#990000">&lt;=</font> i <font color="#990000">/</font> nbDiscretized<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> i <font color="#990000">-</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> nbDiscretized <font color="#990000">-</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">discretis</font></b><font color="#990000">(</font>ll<font color="#990000">,</font> nbDiscretized<font color="#990000">=</font>nbDiscre<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>ll<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> <font color="#990000">(</font>nbDiscretized <font color="#990000">**</font> i<font color="#990000">)</font> <font color="#990000">*</font> <b><font color="#000000">nbdis</font></b><font color="#990000">(</font>ll<font color="#990000">[</font>i<font color="#990000">],</font> nbDiscretized<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;process <font color="#990000">=</font> True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">try</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>self<font color="#990000">.</font>ldiscretize <font color="#990000">!=</font> self<font color="#990000">.</font>lnetwork<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;process <font color="#990000">=</font> False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">except</font></b> AttributeError<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>ldiscretize <font color="#990000">=</font> self<font color="#990000">.</font>lnetwork<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>process<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_div'</font><font color="#990000">][</font>ishape<font color="#990000">][</font>self<font color="#990000">.</font>lepoch<font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize'</font><font color="#990000">][</font>ishape<font color="#990000">][</font>self<font color="#990000">.</font>lepoch<font color="#990000">]</font> <font color="#990000">+=</font> <b><font color="#000000">discretis</font></b><font color="#990000">(</font>self<font color="#990000">.</font>lnetwork<font color="#990000">[</font>key<font color="#990000">].</font>stateHiddenNeurons<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>ishape<font color="#990000">])</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>ishape<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>lepoch<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">elif</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>ishape<font color="#990000">][</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>ishape<font color="#990000">])</font> <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">]</font> <font color="#990000">!=</font> self<font color="#990000">.</font>lepoch<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>plots<font color="#990000">[</font><font color="#FF0000">'discretize_valid'</font><font color="#990000">][</font>ishape<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>lepoch<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">prototypes</font></b><font color="#990000">(</font>self<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lplot <font color="#990000">=</font> <font color="#990000">[[</font><font color="#993399">0</font><font color="#990000">.</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>ninputs<font color="#990000">)]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>ninputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>i <font color="#990000">==</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>outputs<font color="#990000">[</font>k<font color="#990000">])):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lplot<font color="#990000">[</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <font color="#990000">+=</font> self<font color="#990000">.</font>examples<font color="#990000">.</font>inputs<font color="#990000">[</font>k<font color="#990000">][</font>j<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fig <font color="#990000">=</font> plt<font color="#990000">.</font><b><font color="#000000">figure</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">clf</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rpr<font color="#990000">.</font><b><font color="#000000">show_repr</font></b><font color="#990000">(</font>lplot<font color="#990000">[</font>i<font color="#990000">],</font> <font color="#993399">16</font><font color="#990000">,</font> fig<font color="#990000">,</font> <font color="#993399">250</font> <font color="#990000">+</font> i<font color="#990000">,</font> i<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path <font color="#990000">=</font> <font color="#FF0000">"/tmp/pyplot.%s.%s.png"</font> <font color="#990000">%</font> <font color="#990000">(</font>sys<font color="#990000">.</font>argv<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">],</font> time<font color="#990000">.</font><b><font color="#000000">strftime</font></b><font color="#990000">(</font><font color="#FF0000">"%m-%d-%H-%M-%S"</font><font color="#990000">,</font> time<font color="#990000">.</font><b><font color="#000000">localtime</font></b><font color="#990000">()))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">savefig</font></b><font color="#990000">(</font>path<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</tt><br/>
</body>
