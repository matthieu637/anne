<html>
<head>
  <script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  </script>
  <script type="text/javascript" src="mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body style="font-size:1.15em">
<tt><i><font color="#9A1900"># -*- coding: UTF-8 -*-</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<i><font color="#9A1900">Created on 14 February 2012</font></i><br/>
<br/>
<i><font color="#9A1900">@author: Matthieu Zimmer</font></i><br/>
<br/>
<i><font color="#9A1900">Provides some basics functions and constants</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<br/>
<b><font color="#000080">from</font></b>&nbsp;random <b><font color="#000080">import</font></b> random<br/>
<br/>
NB_CORE <font color="#990000">=</font>&nbsp;<font color="#993399">4</font><br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">index_max</font></b><font color="#990000">(</font>l<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;returns the index of the max value in the list l</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;m <font color="#990000">=</font> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>l<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>l<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">&gt;</font> l<font color="#990000">[</font>m<font color="#990000">]):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m <font color="#990000">=</font> i<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> m<br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">last_index_max</font></b><font color="#990000">(</font>l<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;returns the index of the max value in the list l by the end</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;m <font color="#990000">=</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>l<font color="#990000">)</font> <font color="#990000">-</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;ln <font color="#990000">=</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>l<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>l<font color="#990000">)+</font><font color="#993399">1</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>l<font color="#990000">[</font>ln <font color="#990000">-</font> i<font color="#990000">]</font> <font color="#990000">&gt;</font> l<font color="#990000">[</font>m<font color="#990000">]):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m <font color="#990000">=</font> ln <font color="#990000">-</font> i<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> m<br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">index_min</font></b><font color="#990000">(</font>l<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;returns the index of the max value in the list l</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;m <font color="#990000">=</font> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>l<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>l<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">&lt;</font> l<font color="#990000">[</font>m<font color="#990000">]):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m <font color="#990000">=</font> i<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> m<br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">index_max_nth</font></b><font color="#990000">(</font>l<font color="#990000">,</font> n<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;cl <font color="#990000">=</font> <b><font color="#000000">list</font></b><font color="#990000">(</font>l<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;vmin <font color="#990000">=</font> <b><font color="#000000">min</font></b><font color="#990000">(</font>cl<font color="#990000">)</font> <font color="#990000">-</font> <font color="#993399">1</font><br/>
<i><font color="#9A1900">#    - 1</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>n<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imax <font color="#990000">=</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>cl<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl<font color="#990000">[</font>imax<font color="#990000">]</font> <font color="#990000">=</font> vmin<br/>
<i><font color="#9A1900">#        print(i, cl)</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>cl<font color="#990000">)</font><br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">randmm</font></b><font color="#990000">(</font>vmin<font color="#990000">,</font> vmax<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;returns a float between [vmin, vmax[</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> vmin <font color="#990000">+</font> <b><font color="#000000">random</font></b><font color="#990000">()</font> <font color="#990000">*</font> <b><font color="#000000">abs</font></b><font color="#990000">(</font>vmax <font color="#990000">-</font> vmin<font color="#990000">)</font><br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">compare</font></b><font color="#990000">(</font>list_model<font color="#990000">,</font> list_test<font color="#990000">,</font> threshold<font color="#990000">=</font><font color="#993399">0.5</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>list_model<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>list_model<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">==</font> <font color="#993399">0</font> <b><font color="#0000FF">and</font></b> list_test<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">&gt;</font> threshold<font color="#990000">)</font> <b><font color="#0000FF">or</font></b> <font color="#990000">\</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">(</font>list_model<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">==</font> <font color="#993399">1</font> <b><font color="#0000FF">and</font></b> list_test<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">&lt;</font> threshold<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#993399">1</font><br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">compare_f</font></b><font color="#990000">(</font>list_model<font color="#990000">,</font> list_test<font color="#990000">,</font> threshold<font color="#990000">=</font><font color="#993399">0.05</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>list_model<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">abs</font></b><font color="#990000">(</font>list_model<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">-</font> list_test<font color="#990000">[</font>i<font color="#990000">])</font> <font color="#990000">&gt;</font> threshold<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> True<br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font>n<font color="#990000">,</font> depth<font color="#990000">=</font>NB_CORE<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[</font>n <font color="#990000">//</font> depth<font color="#990000">]</font> <font color="#990000">*</font> depth<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>n <font color="#990000">%</font> depth<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> res<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font>charge<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;buffer <font color="#990000">=</font> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;i <font color="#990000">=</font> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> c <b><font color="#0000FF">in</font></b> charge<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">((</font>i <font color="#990000">,</font>buffer<font color="#990000">,</font> buffer <font color="#990000">+</font> c<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer <font color="#990000">+=</font> c<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> res<br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">print_liste</font></b><font color="#990000">(</font>l<font color="#990000">,</font> n<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;i <font color="#990000">=</font> <font color="#993399">0</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">while</font></b> <font color="#990000">(</font>i <font color="#990000">&lt;</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>l<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><font color="#FF0000">""</font><font color="#990000">.</font><b><font color="#000000">join</font></b><font color="#990000">([</font><font color="#FF0000">"x"</font> <b><font color="#0000FF">if</font></b> l<font color="#990000">[</font>j<font color="#990000">]</font> <font color="#990000">&gt;=</font> <font color="#993399">0.5</font> <b><font color="#0000FF">else</font></b> <font color="#FF0000">"."</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>i<font color="#990000">,</font> i<font color="#990000">+</font>n<font color="#990000">)]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i <font color="#990000">+=</font> n<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<b><font color="#0000FF">if</font></b>&nbsp;__name__ <font color="#990000">==</font> <font color="#FF0000">'__main__'</font><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">42</font><font color="#990000">,</font> <font color="#993399">4</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">41</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">41</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">45</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">))</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">42</font><font color="#990000">,</font> <font color="#993399">4</font><font color="#990000">)))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">41</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">)))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">41</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">)))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font><b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><font color="#993399">45</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">)))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><b><font color="#000000">last_index_max</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">]))</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">print_liste</font></b><font color="#990000">([</font><font color="#993399">0.1</font><font color="#990000">,</font> <font color="#993399">0.6</font><font color="#990000">,</font> <font color="#993399">0.4</font><font color="#990000">,</font> <font color="#993399">0.8</font><font color="#990000">],</font> <font color="#993399">2</font><font color="#990000">)</font><br/>
</tt><br/>
</body>
