<html>
<head>
  <script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  </script>
  <script type="text/javascript" src="mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body style="font-size:1.15em">
<tt><i><font color="#9A1900"># -*- coding: UTF-8 -*-</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<i><font color="#9A1900">Created on 13 February 2012</font></i><br/>
<br/>
<i><font color="#9A1900">@author: Matthieu Zimmer</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<br/>
<b><font color="#000080">from</font></b>&nbsp;math <b><font color="#000080">import</font></b> sqrt<br/>
<b><font color="#000080">from</font></b>&nbsp;perceptron <b><font color="#000080">import</font></b> Perceptron<font color="#990000">,</font> PerceptronR0to1<br/>
<b><font color="#000080">from</font></b>&nbsp;multiprocessing <b><font color="#000080">import</font></b> Process<font color="#990000">,</font> Array<font color="#990000">,</font> Queue<br/>
<b><font color="#000080">from</font></b>&nbsp;utils <b><font color="#000080">import</font></b> NB_CORE<font color="#990000">,</font> multithread_repartition<font color="#990000">,</font> charge_to_indice<br/>
<br/>
<b><font color="#0000FF">class</font></b>&nbsp;MultilayerPerceptron<font color="#990000">:</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;Deprecated</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;describes a neural network with 2 layers ( hidden and output )</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#defines grid values, R1to1 means Real in [-1, 1], R0to1 means Real in [0,1]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">(</font>R1to1<font color="#990000">,</font> R0to1<font color="#990000">)</font> <font color="#990000">=</font> <font color="#990000">(-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">__init__</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nbr_input<font color="#990000">,</font> nbr_hidden<font color="#990000">,</font> nbr_output<font color="#990000">,</font> grid<font color="#990000">=</font>R1to1<font color="#990000">,</font> learning_rate<font color="#990000">=</font><font color="#993399">0.1</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;momentum<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">.,</font> temperature<font color="#990000">=</font><font color="#993399">1</font><font color="#990000">.,</font> random<font color="#990000">=</font>True<font color="#990000">,</font> enable_bias<font color="#990000">=</font>True<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builds a neural network with 2 layers</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nbr_input is the number of inputs to the neurons in the hidden layer</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;see Perceptron.__init__() for more information about other parameters</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>grid <font color="#990000">!=</font> self<font color="#990000">.</font>R1to1 <b><font color="#0000FF">and</font></b> grid <font color="#990000">!=</font> self<font color="#990000">.</font>R0to1<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">raise</font></b> <b><font color="#000000">Exception</font></b><font color="#990000">(</font><font color="#FF0000">"%d : unknown grid. Please use : %d or %d"</font> <font color="#990000">%</font> <font color="#990000">(</font>grid<font color="#990000">,</font> self<font color="#990000">.</font>R1to1<font color="#990000">,</font> self<font color="#990000">.</font>R0to1<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>outputNeurons <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> grid <font color="#990000">==</font> self<font color="#990000">.</font>R1to1<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph <font color="#990000">=</font> <b><font color="#000000">Perceptron</font></b><font color="#990000">(</font>nbr_input<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>HIDDEN<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph <font color="#990000">=</font> <b><font color="#000000">PerceptronR0to1</font></b><font color="#990000">(</font>nbr_input<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>HIDDEN<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ph<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_output<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> grid <font color="#990000">==</font> self<font color="#990000">.</font>R1to1<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;po <font color="#990000">=</font> <b><font color="#000000">Perceptron</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>OUTPUT<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;po <font color="#990000">=</font> <b><font color="#000000">PerceptronR0to1</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>OUTPUT<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>outputNeurons<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>po<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateOutputNeurons <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateHiddenNeurons <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_last_inputs <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> True<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(</font>self<font color="#990000">,</font> vmin<font color="#990000">=</font> <font color="#990000">-</font><font color="#993399">0.25</font><font color="#990000">,</font> vmax<font color="#990000">=</font><font color="#993399">0.25</font><font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assigns a random value between [ vmin, vmax [ to all the weights of the network </font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>hiddenNeurons <font color="#990000">+</font> self<font color="#990000">.</font>outputNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(</font>vmin<font color="#990000">,</font> vmax<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">init_weights</font></b><font color="#990000">(</font>self<font color="#990000">,</font> val<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assigns the value val to all the weights of the network</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>hiddenNeurons <font color="#990000">+</font> self<font color="#990000">.</font>outputNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font><b><font color="#000000">init_weights</font></b><font color="#990000">(</font>val<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_output</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the responses list of the output neurons to these data inputs</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#avoids unnecessary computations</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#0000FF">not</font></b> self<font color="#990000">.</font>_network_updated <b><font color="#0000FF">and</font></b> self<font color="#990000">.</font>_last_inputs <font color="#990000">==</font> inputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_last_inputs <font color="#990000">=</font> inputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#determine the state of hidden neurons</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateHidden <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>hiddenNeurons <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateHidden<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>neuron<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateHiddenNeurons <font color="#990000">=</font> stateHidden<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#then the output layer</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateOutputs <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateOutputs<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>neuron<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>stateHidden<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateOutputNeurons <font color="#990000">=</font> stateOutputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_RMS</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the RMS ( Root Mean Square ) for the entire output layer</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the RMS ( Root Mean Square ) according to the formula :</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ \sqrt{ \frac{1}{n} \sum \limits_{i=1}^{n} ( o_{i} - d_{i} )^2 } $</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ with \left\lbrace \begin{array}{lll} n : number\ of\ neurons\ on\ the\ output\ layer\\ o : values\ obtained \\ d : values\ desired \end{array} \right.$</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it is used to determine the total error of the network)</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <b><font color="#000000">sqrt</font></b><font color="#990000">(</font>self<font color="#990000">.</font><b><font color="#000000">calc_MS_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_MS</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_MS_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_MS_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#990000">(</font>self<font color="#990000">.</font><b><font color="#000000">calc_SE_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font>imax <font color="#990000">-</font> imin<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_SE</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_SE_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_SE_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> <font color="#990000">(</font>self<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">-</font> outputs<font color="#990000">[</font>i<font color="#990000">])</font> <font color="#990000">**</font> <font color="#993399">2</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_ME</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_ME_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_ME_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#990000">(</font>self<font color="#990000">.</font><b><font color="#000000">calc_E_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font>imax <font color="#990000">-</font> imin<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_E</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_E_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_E_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> <b><font color="#000000">abs</font></b><font color="#990000">(</font>self<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">-</font> outputs<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_sum_dw_hidden</font></b><font color="#990000">(</font>self<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>hiddenNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> neuron<font color="#990000">.</font><b><font color="#000000">calc_sum_dw</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_sum_dw_outputs</font></b><font color="#990000">(</font>self<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> neuron<font color="#990000">.</font><b><font color="#000000">calc_sum_dw</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">set_learning_rate</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nlr<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons <font color="#990000">+</font> self<font color="#990000">.</font>hiddenNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font>learning_rate <font color="#990000">=</font> nlr<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">set_momentum</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nm<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons <font color="#990000">+</font> self<font color="#990000">.</font>hiddenNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font>momentum <font color="#990000">=</font> nm<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">train</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trains the network to associate inputs to outputs ( by using the backpropagation algorithm )</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#build y the error vector to propagate</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_error_propagation</font></b><font color="#990000">(</font>outputs<font color="#990000">[</font>i<font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_sum <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_sum <font color="#990000">+=</font> self<font color="#990000">.</font>outputNeurons<font color="#990000">[</font>j<font color="#990000">].</font>weights<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">*</font> y<font color="#990000">[</font>j<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_error_propagation</font></b><font color="#990000">(</font>w_sum<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#updates all weights of the network</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">update_weights</font></b><font color="#990000">(</font>yy<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">,</font> inputs<font color="#990000">)</font><br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>outputNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">update_weights</font></b><font color="#990000">(</font>y<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">,</font> self<font color="#990000">.</font>stateHiddenNeurons<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<b><font color="#0000FF">class</font></b>&nbsp;MultilayerPerceptronM<font color="#990000">:</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;describes a neural network with multiples layers</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#defines grid values, R1to1 means Real in [-1, 1], R0to1 means Real in [0,1]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">(</font>R1to1<font color="#990000">,</font> R0to1<font color="#990000">)</font> <font color="#990000">=</font> <font color="#990000">(-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">__init__</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nbr_input<font color="#990000">,</font> nbr_hidden<font color="#990000">,</font> nbr_output<font color="#990000">,</font> nbr_layer<font color="#990000">,</font> grid<font color="#990000">=</font>R1to1<font color="#990000">,</font> learning_rate<font color="#990000">=</font><font color="#993399">0.1</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;momentum<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">.,</font> temperature<font color="#990000">=</font><font color="#993399">1</font><font color="#990000">.,</font> random<font color="#990000">=</font>True<font color="#990000">,</font> enable_bias<font color="#990000">=</font>True<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builds a neural network with multiples layers</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nbr_input is the number of inputs to the neurons in the hidden layer</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;see Perceptron.__init__() for more information about other parameters</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>grid <font color="#990000">!=</font> self<font color="#990000">.</font>R1to1 <b><font color="#0000FF">and</font></b> grid <font color="#990000">!=</font> self<font color="#990000">.</font>R0to1<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">raise</font></b> <b><font color="#000000">Exception</font></b><font color="#990000">(</font><font color="#FF0000">"%d : unknown grid. Please use : %d or %d"</font> <font color="#990000">%</font> <font color="#990000">(</font>grid<font color="#990000">,</font> self<font color="#990000">.</font>R1to1<font color="#990000">,</font> self<font color="#990000">.</font>R0to1<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons <font color="#990000">=</font> <font color="#990000">[[]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_layer<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>outputNeurons <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> grid <font color="#990000">==</font> self<font color="#990000">.</font>R1to1<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph <font color="#990000">=</font> <b><font color="#000000">Perceptron</font></b><font color="#990000">(</font>nbr_input<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>HIDDEN<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph <font color="#990000">=</font> <b><font color="#000000">PerceptronR0to1</font></b><font color="#990000">(</font>nbr_input<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>HIDDEN<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ph<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> nbr_layer<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> grid <font color="#990000">==</font> self<font color="#990000">.</font>R1to1<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph <font color="#990000">=</font> <b><font color="#000000">Perceptron</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>HIDDEN<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph <font color="#990000">=</font> <b><font color="#000000">PerceptronR0to1</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>HIDDEN<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ph<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_output<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> grid <font color="#990000">==</font> self<font color="#990000">.</font>R1to1<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;po <font color="#990000">=</font> <b><font color="#000000">Perceptron</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>OUTPUT<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;po <font color="#990000">=</font> <b><font color="#000000">PerceptronR0to1</font></b><font color="#990000">(</font>nbr_hidden<font color="#990000">,</font> learning_rate<font color="#990000">,</font> momentum<font color="#990000">,</font> temperature<font color="#990000">,</font> Perceptron<font color="#990000">.</font>OUTPUT<font color="#990000">,</font> random<font color="#990000">,</font> enable_bias<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>outputNeurons<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>po<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateOutputNeurons <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateHiddenNeurons <font color="#990000">=</font> <font color="#990000">[[]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbr_layer<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_last_inputs <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_nbr_layer <font color="#990000">=</font> nbr_layer<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> True<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(</font>self<font color="#990000">,</font> vmin<font color="#990000">=</font> <font color="#990000">-</font><font color="#993399">0.25</font><font color="#990000">,</font> vmax<font color="#990000">=</font><font color="#993399">0.25</font><font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assigns a random value between [ vmin, vmax [ to all the weights of the network </font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> <font color="#990000">[</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">]))]</font> <font color="#990000">+</font> self<font color="#990000">.</font>outputNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(</font>vmin<font color="#990000">,</font> vmax<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">init_weights</font></b><font color="#990000">(</font>self<font color="#990000">,</font> val<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assigns the value val to all the weights of the network</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> <font color="#990000">[</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">]))]</font> <font color="#990000">+</font> self<font color="#990000">.</font>outputNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font><b><font color="#000000">init_weights</font></b><font color="#990000">(</font>val<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_output</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the responses list of the output neurons to these data inputs</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#avoids unnecessary computations</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#0000FF">not</font></b> self<font color="#990000">.</font>_network_updated <b><font color="#0000FF">and</font></b> self<font color="#990000">.</font>_last_inputs <font color="#990000">==</font> inputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_last_inputs <font color="#990000">=</font> inputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#determine the state of hidden neurons</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateHidden <font color="#990000">=</font> <font color="#990000">[[]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateHidden<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>neuron<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> self<font color="#990000">.</font>_nbr_layer<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateHidden<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>neuron<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>stateHidden<font color="#990000">[</font>i <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateHiddenNeurons <font color="#990000">=</font> stateHidden<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#then the output layer</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateOutputs <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateOutputs<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>neuron<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>stateHidden<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateOutputNeurons <font color="#990000">=</font> stateOutputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_RMS</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the RMS ( Root Mean Square ) for the entire output layer</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the RMS ( Root Mean Square ) according to the formula :</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ \sqrt{ \frac{1}{n} \sum \limits_{i=1}^{n} ( o_{i} - d_{i} )^2 } $</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ with \left\lbrace \begin{array}{lll} n : number\ of\ neurons\ on\ the\ output\ layer\\ o : values\ obtained \\ d : values\ desired \end{array} \right.$</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it is used to determine the total error of the network)</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <b><font color="#000000">sqrt</font></b><font color="#990000">(</font>self<font color="#990000">.</font><b><font color="#000000">calc_MS_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_MS</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_MS_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_MS_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#990000">(</font>self<font color="#990000">.</font><b><font color="#000000">calc_SE_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font>imax <font color="#990000">-</font> imin<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_SE</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_SE_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_SE_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> <font color="#990000">(</font>self<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">-</font> outputs<font color="#990000">[</font>i<font color="#990000">])</font> <font color="#990000">**</font> <font color="#993399">2</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_ME</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_ME_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_ME_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#990000">(</font>self<font color="#990000">.</font><b><font color="#000000">calc_E_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">)</font> <font color="#990000">/</font> <font color="#990000">(</font>imax <font color="#990000">-</font> imin<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_E</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font><b><font color="#000000">calc_E_range</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>outputs<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_E_range</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> <b><font color="#000000">abs</font></b><font color="#990000">(</font>self<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">-</font> outputs<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_sum_dw_hidden</font></b><font color="#990000">(</font>self<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> <font color="#990000">[</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">]))]:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> neuron<font color="#990000">.</font><b><font color="#000000">calc_sum_dw</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_sum_dw_outputs</font></b><font color="#990000">(</font>self<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s <font color="#990000">+=</font> neuron<font color="#990000">.</font><b><font color="#000000">calc_sum_dw</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> s<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">set_learning_rate</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nlr<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons <font color="#990000">+</font> <font color="#990000">[</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">]))]:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font>learning_rate <font color="#990000">=</font> nlr<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">set_momentum</font></b><font color="#990000">(</font>self<font color="#990000">,</font> nm<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> neuron <b><font color="#0000FF">in</font></b> self<font color="#990000">.</font>outputNeurons <font color="#990000">+</font> <font color="#990000">[</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">][</font>j<font color="#990000">]</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>i<font color="#990000">]))]:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neuron<font color="#990000">.</font>momentum <font color="#990000">=</font> nm<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">train</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trains the network to associate inputs to outputs ( by using the backpropagation algorithm )</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#build y the error vector to propagate</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy <font color="#990000">=</font> <font color="#990000">[[]</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">+</font> <font color="#993399">1</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_error_propagation</font></b><font color="#990000">(</font>outputs<font color="#990000">[</font>i<font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">])):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_sum <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_sum <font color="#990000">+=</font> self<font color="#990000">.</font>outputNeurons<font color="#990000">[</font>j<font color="#990000">].</font>weights<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">*</font> yy<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">][</font>j<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">][</font>i<font color="#990000">].</font><b><font color="#000000">calc_error_propagation</font></b><font color="#990000">(</font>w_sum<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> l <b><font color="#0000FF">in</font></b> <b><font color="#000000">sorted</font></b><font color="#990000">(</font><b><font color="#000000">range</font></b><font color="#990000">(</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">),</font> reverse<font color="#990000">=</font>True<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>l<font color="#990000">])):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_sum <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> j <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>l <font color="#990000">+</font> <font color="#993399">1</font><font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_sum <font color="#990000">+=</font> self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>l <font color="#990000">+</font> <font color="#993399">1</font><font color="#990000">][</font>j<font color="#990000">].</font>weights<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">*</font> yy<font color="#990000">[</font>l <font color="#990000">+</font> <font color="#993399">1</font><font color="#990000">][</font>j<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy<font color="#990000">[</font>l<font color="#990000">].</font><b><font color="#000000">append</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>l<font color="#990000">][</font>i<font color="#990000">].</font><b><font color="#000000">calc_error_propagation</font></b><font color="#990000">(</font>w_sum<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#updates all weights of the network</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font>i<font color="#990000">].</font><b><font color="#000000">update_weights</font></b><font color="#990000">(</font>yy<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">,</font> inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> l <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> self<font color="#990000">.</font>_nbr_layer<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>l<font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font>l<font color="#990000">][</font>i<font color="#990000">].</font><b><font color="#000000">update_weights</font></b><font color="#990000">(</font>yy<font color="#990000">[</font>l<font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">,</font> self<font color="#990000">.</font>stateHiddenNeurons<font color="#990000">[</font>l <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>outputNeurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">update_weights</font></b><font color="#990000">(</font>yy<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer<font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">,</font> self<font color="#990000">.</font>stateHiddenNeurons<font color="#990000">[</font>self<font color="#990000">.</font>_nbr_layer <font color="#990000">-</font> <font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> True<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<b><font color="#0000FF">class</font></b>&nbsp;<b><font color="#000000">MultilayerPerceptronXT</font></b><font color="#990000">(</font>MultilayerPerceptron<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;Multi-layer Perceptron Multi Thread</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;Provides some additional methods to use multithreading</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">calc_output</font></b><font color="#990000">(</font>self<font color="#990000">,</font> inputs<font color="#990000">):</font><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns the responses list of the output neurons to these data inputs</font></i><br/>
<i><font color="#9A1900">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'''</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">_multithread_computations</font></b><font color="#990000">(</font>neurons<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">,</font> array<font color="#990000">,</font> queue<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n <font color="#990000">=</font> neurons<font color="#990000">[</font>i<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp <font color="#990000">=</font> neurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> tmp<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue<font color="#990000">.</font><b><font color="#000000">put</font></b><font color="#990000">(</font>n<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">_multithread_computations2</font></b><font color="#990000">(</font>neurons<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">,</font> array<font color="#990000">,</font> hidden_inputs<font color="#990000">,</font> queue<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>imin<font color="#990000">,</font> imax<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n <font color="#990000">=</font> neurons<font color="#990000">[</font>i<font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp <font color="#990000">=</font> neurons<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>hidden_inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> tmp<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue<font color="#990000">.</font><b><font color="#000000">put</font></b><font color="#990000">(</font>n<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">_queue_to_list</font></b><font color="#990000">(</font>queue<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">while</font></b> <b><font color="#0000FF">not</font></b> queue<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">empty</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>queue<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">get_nowait</font></b><font color="#990000">())</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> l<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#avoids unnecessary computations</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#0000FF">not</font></b> self<font color="#990000">.</font>_network_updated <b><font color="#0000FF">and</font></b> self<font color="#990000">.</font>_last_inputs <font color="#990000">==</font> inputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_network_updated <font color="#990000">=</font> False<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>_last_inputs <font color="#990000">=</font> inputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_hidden <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">Queue</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#determine the state of hidden neurons</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charge_number <font color="#990000">=</font> <b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">),</font> NB_CORE<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateHidden <font color="#990000">=</font> <b><font color="#000000">Array</font></b><font color="#990000">(</font><font color="#FF0000">'d'</font><font color="#990000">,</font> <font color="#990000">[</font><font color="#993399">0</font><font color="#990000">.]</font> <font color="#990000">*</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pool <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">Process</font></b><font color="#990000">(</font>target<font color="#990000">=</font>_multithread_computations<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args<font color="#990000">=(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">,</font> stateHidden<font color="#990000">,</font> new_hidden<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> i<font color="#990000">,</font> imin<font color="#990000">,</font> imax <b><font color="#0000FF">in</font></b> <b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font>charge_number<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font>pool<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">start</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font>pool<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">join</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateHiddenNeurons <font color="#990000">=</font> stateHidden<br/>
<i><font color="#9A1900">#        self.hiddenNeurons =  _queue_to_list(new_hidden)</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_output <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">Queue</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#then the output layer</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charge_number <font color="#990000">=</font> <b><font color="#000000">multithread_repartition</font></b><font color="#990000">(</font><b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">),</font> NB_CORE<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateOutputs <font color="#990000">=</font> <b><font color="#000000">Array</font></b><font color="#990000">(</font><font color="#FF0000">'d'</font><font color="#990000">,</font> <font color="#990000">[</font><font color="#993399">0</font><font color="#990000">.]</font> <font color="#990000">*</font> <b><font color="#000000">len</font></b><font color="#990000">(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pool <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">Process</font></b><font color="#990000">(</font>target<font color="#990000">=</font>_multithread_computations2<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args<font color="#990000">=(</font>self<font color="#990000">.</font>outputNeurons<font color="#990000">,</font> imin<font color="#990000">,</font> imax<font color="#990000">,</font> stateOutputs<font color="#990000">,</font> stateHidden<font color="#990000">,</font> new_output<font color="#990000">[</font>i<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> i<font color="#990000">,</font> imin<font color="#990000">,</font> imax <b><font color="#0000FF">in</font></b> <b><font color="#000000">charge_to_indice</font></b><font color="#990000">(</font>charge_number<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font>pool<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">start</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font>pool<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">join</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>NB_CORE<font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self<font color="#990000">.</font>stateOutputNeurons <font color="#990000">=</font> stateOutputs<br/>
<i><font color="#9A1900">#        self.hiddenNeurons =  _queue_to_list(new_output)</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>self<font color="#990000">.</font>hiddenNeurons<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">].</font>_weights_updated<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">exit</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> self<font color="#990000">.</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<b><font color="#0000FF">if</font></b>&nbsp;__name__ <font color="#990000">==</font> <font color="#FF0000">'__main__'</font><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#XOR test on [-1, 1]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;n <font color="#990000">=</font> <b><font color="#000000">MultilayerPerceptron</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> grid<font color="#990000">=</font>MultilayerPerceptron<font color="#990000">.</font>R1to1<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> epoch <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">700</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">],</font> <font color="#990000">[-</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">],</font> <font color="#990000">[</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">],</font> <font color="#990000">[</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">],</font> <font color="#990000">[-</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[-0.9424440588256111]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[0.9583671093424109]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[0.9581018151457293]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[-0.9435578546516472]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#XOR test on [0, 1]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;n <font color="#990000">=</font> <b><font color="#000000">MultilayerPerceptron</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">,</font> grid<font color="#990000">=</font>MultilayerPerceptron<font color="#990000">.</font>R0to1<font color="#990000">,</font> momentum<font color="#990000">=</font><font color="#993399">0.2</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> epoch <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">1000</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">],</font> <font color="#990000">[</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">],</font> <font color="#990000">[</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">],</font> <font color="#990000">[</font><font color="#993399">0</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>n<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">([</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[0.18486650386859885]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[0.8124738577513108]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[0.7566651974008758]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#[0.257136216923515]</font></i><br/>
<br/>
</tt><br/>
</body>
