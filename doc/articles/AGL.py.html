<html>
<head>
  <script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  </script>
  <script type="text/javascript" src="mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body style="font-size:1.15em">
<tt><i><font color="#9A1900">'''</font></i><br/>
<i><font color="#9A1900">Created on 6 March 2012</font></i><br/>
<br/>
<i><font color="#9A1900">@author: Matthieu Zimmer</font></i><br/>
<br/>
<i><font color="#9A1900">Artificial Grammar Learning</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<br/>
<b><font color="#000080">from</font></b>&nbsp;data <b><font color="#000080">import</font></b> DataFile<br/>
<b><font color="#000080">from</font></b>&nbsp;random <b><font color="#000080">import</font></b> shuffle<br/>
<b><font color="#000080">from</font></b>&nbsp;multilayerp <b><font color="#000080">import</font></b> MultilayerPerceptron<br/>
<b><font color="#000080">from</font></b>&nbsp;perceptron <b><font color="#000080">import</font></b> Perceptron<font color="#990000">,</font> PerceptronN0to1<font color="#990000">,</font> PerceptronR0to1<br/>
<b><font color="#000080">from</font></b>&nbsp;utils <b><font color="#000080">import</font></b> index_max<br/>
<b><font color="#000080">from</font></b>&nbsp;random <b><font color="#000080">import</font></b> randint<br/>
<b><font color="#000080">import</font></b>&nbsp;matplotlib<font color="#990000">.</font>pyplot as plt<br/>
<br/>
<br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">random_pattern</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;result <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;nb_letter <font color="#990000">=</font> <b><font color="#000000">randint</font></b><font color="#990000">(</font><font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">8</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">8</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>i <font color="#990000">&lt;</font> nb_letter<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;letter <font color="#990000">=</font> <b><font color="#000000">randint</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">5</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">6</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>k <font color="#990000">==</font> letter<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> k <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">6</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>k <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <font color="#990000">(</font>result<font color="#990000">,</font> result<font color="#990000">)</font><br/>
<br/>
<b><font color="#0000FF">def</font></b>&nbsp;<b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>pat<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">8</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>pat<font color="#990000">[</font>i <font color="#990000">*</font> <font color="#993399">6</font><font color="#990000">:</font>i <font color="#990000">*</font> <font color="#993399">6</font> <font color="#990000">+</font> <font color="#993399">6</font><font color="#990000">]))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> res<br/>
<br/>
<b><font color="#0000FF">if</font></b>&nbsp;__name__ <font color="#990000">==</font> <font color="#FF0000">'__main__'</font><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ptrain_pattern <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">random_pattern</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">80</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<i><font color="#9A1900">#    print(ptrain_pattern[0][0])</font></i><br/>
<i><font color="#9A1900">#    print(pattern_to_list(ptrain_pattern[0][0]))</font></i><br/>
<i><font color="#9A1900">#    exit()</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;first_order <font color="#990000">=</font> <b><font color="#000000">MultilayerPerceptron</font></b><font color="#990000">(</font><font color="#993399">48</font><font color="#990000">,</font> <font color="#993399">40</font><font color="#990000">,</font> <font color="#993399">48</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">0.4</font><font color="#990000">,</font> <font color="#993399">0.5</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">.,</font> False<font color="#990000">,</font> True<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;high_order <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">PerceptronR0to1</font></b><font color="#990000">(</font><font color="#993399">48</font><font color="#990000">,</font> <font color="#993399">0.4</font><font color="#990000">,</font> <font color="#993399">0.5</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">.,</font> Perceptron<font color="#990000">.</font>OUTPUT<font color="#990000">,</font> False<font color="#990000">,</font> True<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
<i><font color="#9A1900">#    high_order = [PerceptronN0to1(48, 0.4, 0.5, False) for _ in range(2)]</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;high_order<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">].</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">.,</font> <font color="#993399">0.1</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;high_order<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">].</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">.,</font> <font color="#993399">0.1</font><font color="#990000">)</font><br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><font color="#FF0000">"pre-training"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;err <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;the <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;rms <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;rms2 <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nbEpoch <font color="#990000">=</font> <font color="#993399">60</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;l_ex <font color="#990000">=</font> <b><font color="#000000">list</font></b><font color="#990000">(</font><b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">80</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">shuffle</font></b><font color="#990000">(</font>l_ex<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ptrain_pattern_l <font color="#990000">=</font> l_ex<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">:</font><font color="#993399">40</font><font color="#990000">]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#pre-training</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> epoch <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbEpoch<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_exx <font color="#990000">=</font> <b><font color="#000000">list</font></b><font color="#990000">(</font><b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">80</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">shuffle</font></b><font color="#990000">(</font>l_exx<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss2 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> ex <b><font color="#0000FF">in</font></b> l_exx<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#compara</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">48</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">-</font> first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">])</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res2 <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>res2<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">)</font> <font color="#990000">==</font> <b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">1</font><font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>res<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high_order<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">].</font><b><font color="#000000">train</font></b><font color="#990000">(</font>compara<font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high_order<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">].</font><b><font color="#000000">train</font></b><font color="#990000">(</font>compara<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>res<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">1</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high_order<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">].</font><b><font color="#000000">train</font></b><font color="#990000">(</font>compara<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">.)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high_order<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">].</font><b><font color="#000000">train</font></b><font color="#990000">(</font>compara<font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">.)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font>ex <b><font color="#0000FF">in</font></b> ptrain_pattern_l<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>rms_ss <font color="#990000">/</font> <font color="#993399">80</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms2<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">((</font><font color="#993399">80</font> <font color="#990000">-</font> the<font color="#990000">)</font> <font color="#990000">/</font> <font color="#993399">80</font><font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>epoch<font color="#990000">,</font> <font color="#FF0000">"perf 1st : "</font><font color="#990000">,</font> <font color="#990000">(</font><font color="#993399">80</font> <font color="#990000">-</font> the<font color="#990000">),</font> <font color="#FF0000">" | perf 2nd : "</font><font color="#990000">,</font> rms_ss<font color="#990000">,</font> <font color="#FF0000">" | high wag %d"</font> <font color="#990000">%</font> err<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">init_weights_randomly</font></b><font color="#990000">(-</font><font color="#993399">1</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ptrain_pattern <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">random_pattern</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">45</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font><font color="#FF0000">"training"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;nbEpoch <font color="#990000">=</font> <font color="#993399">12</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#training</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> epoch <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font>nbEpoch<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l_exx <font color="#990000">=</font> <b><font color="#000000">list</font></b><font color="#990000">(</font><b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">45</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">shuffle</font></b><font color="#990000">(</font>l_exx<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss2 <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> ex <b><font color="#0000FF">in</font></b> l_exx<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#compara</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">48</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">-</font> first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">])</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res2 <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font><b><font color="#000000">list</font></b><font color="#990000">(</font>compara<font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>res2<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">)</font> <font color="#990000">==</font> <b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">1</font><font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>res<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss <font color="#990000">+=</font> <font color="#993399">1</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>res<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">1</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms_ss <font color="#990000">+=</font> <font color="#993399">1</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">train</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">],</font> ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">1</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>rms_ss <font color="#990000">/</font> <font color="#993399">45</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms2<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">((</font><font color="#993399">45</font> <font color="#990000">-</font> the<font color="#990000">)</font> <font color="#990000">/</font> <font color="#993399">45</font><font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>epoch<font color="#990000">,</font> <font color="#FF0000">"perf 1st : "</font><font color="#990000">,</font> <font color="#990000">(</font><font color="#993399">45</font> <font color="#990000">-</font> the<font color="#990000">),</font> <font color="#FF0000">" | perf 2nd : "</font><font color="#990000">,</font> rms_ss<font color="#990000">,</font> <font color="#FF0000">" | high wag %d"</font> <font color="#990000">%</font> err<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">.</font><br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>rms<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label<font color="#990000">=</font><font color="#FF0000">"high-order network"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>rms2<font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label<font color="#990000">=</font><font color="#FF0000">"first-order network"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">axis</font></b><font color="#990000">((</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">60</font> <font color="#990000">+</font> nbEpoch<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">1</font><font color="#990000">.))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">legend</font></b><font color="#990000">(</font>loc<font color="#990000">=</font><font color="#FF0000">'best'</font><font color="#990000">,</font> frameon<font color="#990000">=</font>False<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">()</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#testing</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;pourc <font color="#990000">=</font> <font color="#990000">{</font><font color="#FF0000">'hg_co'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'hg_in'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'lw_co'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'lw_in'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'co'</font><font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'in'</font><font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">}</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;l_ex <font color="#990000">=</font> <b><font color="#000000">list</font></b><font color="#990000">(</font><b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">45</font><font color="#990000">))</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">shuffle</font></b><font color="#990000">(</font>l_ex<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> ex <b><font color="#0000FF">in</font></b> l_ex<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">:</font><font color="#993399">30</font><font color="#990000">]:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#compara</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">48</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">-</font> first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">])</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res33 <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">)</font> <font color="#990000">==</font> <b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">1</font><font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'co'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>res33<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">:</font><i><font color="#9A1900">#high wager</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'hg_co'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'lw_co'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'in'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>res33<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">:</font><i><font color="#9A1900">#high wager</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'hg_in'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'lw_in'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> key <b><font color="#0000FF">in</font></b> pourc<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font>key<font color="#990000">]</font> <font color="#990000">/=</font> <font color="#993399">0.30</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>pourc<font color="#990000">,</font> pourc<font color="#990000">[</font><font color="#FF0000">'lw_co'</font><font color="#990000">],</font> pourc<font color="#990000">[</font><font color="#FF0000">'lw_in'</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ptrain_pattern <font color="#990000">=</font> <font color="#990000">[</font><b><font color="#000000">random_pattern</font></b><font color="#990000">()</font> <b><font color="#0000FF">for</font></b> _ <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">30</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;pourc <font color="#990000">=</font> <font color="#990000">{</font><font color="#FF0000">'hg_co'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'hg_in'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'lw_co'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'lw_in'</font> <font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'co'</font><font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'in'</font><font color="#990000">:</font> <font color="#993399">0</font><font color="#990000">}</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> ex <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">30</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_order<font color="#990000">.</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#compara</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">48</font><font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compara<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">0</font><font color="#990000">][</font>i<font color="#990000">]</font> <font color="#990000">-</font> first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">[</font>i<font color="#990000">])</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res33 <font color="#990000">=</font> <font color="#990000">[</font>high_order<font color="#990000">[</font>i<font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>compara<font color="#990000">)</font> <b><font color="#0000FF">for</font></b> i <b><font color="#0000FF">in</font></b> <b><font color="#000000">range</font></b><font color="#990000">(</font><font color="#993399">2</font><font color="#990000">)]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>first_order<font color="#990000">.</font>stateOutputNeurons<font color="#990000">)</font> <font color="#990000">==</font> <b><font color="#000000">pattern_to_list</font></b><font color="#990000">(</font>ptrain_pattern<font color="#990000">[</font>ex<font color="#990000">][</font><font color="#993399">1</font><font color="#990000">]))</font> <font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'co'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>res33<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">:</font><i><font color="#9A1900">#high wager</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'hg_co'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'lw_co'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'in'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>res33<font color="#990000">)</font> <font color="#990000">==</font> <font color="#993399">0</font><font color="#990000">:</font><i><font color="#9A1900">#high wager</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'hg_in'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">else</font></b><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font><font color="#FF0000">'lw_in'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> key <b><font color="#0000FF">in</font></b> pourc<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pourc<font color="#990000">[</font>key<font color="#990000">]</font> <font color="#990000">/=</font> <font color="#993399">0.30</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">print</font></b><font color="#990000">(</font>pourc<font color="#990000">,</font> pourc<font color="#990000">[</font><font color="#FF0000">'lw_co'</font><font color="#990000">],</font> pourc<font color="#990000">[</font><font color="#FF0000">'lw_in'</font><font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</tt><br/>
</body>
