<html>
<head>
  <script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  </script>
  <script type="text/javascript" src="mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body style="font-size:1.15em">
<tt><i><font color="#9A1900">'''</font></i><br/>
<i><font color="#9A1900">Created on 27 May 2012</font></i><br/>
<br/>
<i><font color="#9A1900">@author: Matthieu Zimmer</font></i><br/>
<i><font color="#9A1900">'''</font></i><br/>
<br/>
<b><font color="#000080">from</font></b>&nbsp;multilayerp <b><font color="#000080">import</font></b> MultilayerPerceptron<br/>
<b><font color="#000080">from</font></b>&nbsp;data <b><font color="#000080">import</font></b> DataFile<br/>
<b><font color="#000080">from</font></b>&nbsp;utils <b><font color="#000080">import</font></b> index_max<font color="#990000">,</font> compare<font color="#990000">,</font> compare_f<br/>
<b><font color="#000080">from</font></b>&nbsp;representation <b><font color="#000080">import</font></b> graph_network<font color="#990000">,</font> graph_networkhidden<br/>
<b><font color="#000080">from</font></b>&nbsp;simulation <b><font color="#000080">import</font></b> Simulation<br/>
<b><font color="#000080">import</font></b>&nbsp;matplotlib<font color="#990000">.</font>pyplot as plt<br/>
<br/>
<b><font color="#0000FF">if</font></b>&nbsp;__name__ <font color="#990000">==</font> <font color="#FF0000">'__main__'</font><font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;mode <font color="#990000">=</font> MultilayerPerceptron<font color="#990000">.</font>R0to1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nbr_network <font color="#990000">=</font> <font color="#993399">5</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;momentum <font color="#990000">=</font> <font color="#993399">0.9</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;lrate <font color="#990000">=</font> <font color="#993399">0.1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;nbr_try <font color="#990000">=</font> <font color="#993399">10</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;nbr_epoch <font color="#990000">=</font> <font color="#993399">1000</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;width <font color="#990000">=</font> <font color="#993399">4</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;Hwidth <font color="#990000">=</font> <font color="#993399">4</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;discretize <font color="#990000">=</font> <font color="#993399">4</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;point <font color="#990000">=</font> <font color="#993399">12</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<i><font color="#9A1900">#   Data Sample Declaration</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">data</font></b><font color="#990000">():</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <b><font color="#000000">DataFile</font></b><font color="#990000">(</font><font color="#FF0000">"digit_shape.txt"</font><font color="#990000">,</font> mode<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<i><font color="#9A1900">#   Network Declaration</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">FoN</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <b><font color="#000000">MultilayerPerceptron</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> inputs <font color="#990000">//</font> <font color="#993399">4</font><font color="#990000">,</font> outputs<font color="#990000">,</font> learning_rate<font color="#990000">=</font>lrate<font color="#990000">,</font> momentum<font color="#990000">=</font>momentum<font color="#990000">,</font> grid<font color="#990000">=</font>mode<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">SoN</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">return</font></b> <b><font color="#000000">MultilayerPerceptron</font></b><font color="#990000">(</font>inputs <font color="#990000">//</font> <font color="#993399">4</font><font color="#990000">,</font> inputs <font color="#990000">//</font> <font color="#993399">2</font><font color="#990000">,</font> inputs <font color="#990000">+</font> inputs <font color="#990000">//</font> <font color="#993399">4</font> <font color="#990000">+</font> outputs<font color="#990000">,</font> learning_rate<font color="#990000">=</font>lrate<font color="#990000">,</font> momentum<font color="#990000">=</font>momentum<font color="#990000">,</font> grid<font color="#990000">=</font>mode<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<i><font color="#9A1900">#   Work on one step</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">step_propagation</font></b><font color="#990000">(</font>network<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>inputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font><b><font color="#000000">calc_output</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">step_statictics</font></b><font color="#990000">(</font>simu<font color="#990000">,</font> network<font color="#990000">,</font> plot<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entire_FoN <font color="#990000">=</font> inputs <font color="#990000">+</font> network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons <font color="#990000">+</font> network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lin <font color="#990000">=</font> simu<font color="#990000">.</font>examples<font color="#990000">.</font>ninputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lhi <font color="#990000">=</font> lin <font color="#990000">+</font> lin <font color="#990000">//</font> <font color="#993399">4</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lout <font color="#990000">=</font> lhi <font color="#990000">+</font> simu<font color="#990000">.</font>examples<font color="#990000">.</font>noutputs<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#rms</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simu<font color="#990000">.</font><b><font color="#000000">rms</font></b><font color="#990000">(</font><font color="#FF0000">'FoN'</font><font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simu<font color="#990000">.</font><b><font color="#000000">rms</font></b><font color="#990000">(</font><font color="#FF0000">'SoN'</font><font color="#990000">,</font> network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">,</font> entire_FoN<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot<font color="#990000">[</font><font color="#FF0000">'SoN_rms_input'</font><font color="#990000">]</font> <font color="#990000">+=</font> network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font><b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">,</font> entire_FoN<font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">,</font> lin<font color="#990000">)</font> <font color="#990000">/</font> lout <font color="#990000">*</font> <font color="#990000">(</font>lin <font color="#990000">-</font> <font color="#993399">0</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot<font color="#990000">[</font><font color="#FF0000">'SoN_rms_hidden'</font><font color="#990000">]</font> <font color="#990000">+=</font> network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font><b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">,</font> entire_FoN<font color="#990000">,</font> lin<font color="#990000">,</font> lhi<font color="#990000">)</font> <font color="#990000">/</font> lout <font color="#990000">*</font> <font color="#990000">(</font>lhi <font color="#990000">-</font> lin<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot<font color="#990000">[</font><font color="#FF0000">'SoN_rms_output'</font><font color="#990000">]</font> <font color="#990000">+=</font> network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font><b><font color="#000000">calc_RMS_range</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">,</font> entire_FoN<font color="#990000">,</font> lhi<font color="#990000">,</font> lout<font color="#990000">)</font> <font color="#990000">/</font> lout <font color="#990000">*</font> <font color="#990000">(</font>lout <font color="#990000">-</font> lhi<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#err</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simu<font color="#990000">.</font><b><font color="#000000">err</font></b><font color="#990000">(</font><font color="#FF0000">'FoN'</font><font color="#990000">,</font> outputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot<font color="#990000">[</font><font color="#FF0000">'SoN_err_input'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font> <font color="#990000">-</font> <b><font color="#000000">compare</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font>stateOutputNeurons<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">:</font>lin<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#0000FF">not</font></b> <b><font color="#000000">compare_f</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">,</font> network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font>stateOutputNeurons<font color="#990000">[</font>lin<font color="#990000">:</font>lhi<font color="#990000">],</font> <font color="#993399">0.3</font><font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot<font color="#990000">[</font><font color="#FF0000">'SoN_err_hidden'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">if</font></b><font color="#990000">(</font><b><font color="#000000">index_max</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font>stateOutputNeurons<font color="#990000">[</font>lhi<font color="#990000">:</font>lout<font color="#990000">])</font> <font color="#990000">!=</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateOutputNeurons<font color="#990000">)):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot<font color="#990000">[</font><font color="#FF0000">'SoN_err_output'</font><font color="#990000">]</font> <font color="#990000">+=</font> <font color="#993399">1</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#discretize</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simu<font color="#990000">.</font><b><font color="#000000">discretize</font></b><font color="#990000">(</font><font color="#FF0000">'FoN'</font><font color="#990000">,</font> <b><font color="#000000">index_max</font></b><font color="#990000">(</font>outputs<font color="#990000">),</font> discretize<font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">step_learn</font></b><font color="#990000">(</font>network<font color="#990000">,</font> inputs<font color="#990000">,</font> outputs<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#Learning</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entire_FoN <font color="#990000">=</font> inputs <font color="#990000">+</font> network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons <font color="#990000">+</font> network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateOutputNeurons<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network<font color="#990000">[</font><font color="#FF0000">'SoN'</font><font color="#990000">].</font><b><font color="#000000">train</font></b><font color="#990000">(</font>network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>stateHiddenNeurons<font color="#990000">,</font> entire_FoN<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font><b><font color="#000000">train</font></b><font color="#990000">(</font>inputs<font color="#990000">,</font> outputs<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">moregraph1</font></b><font color="#990000">(</font>plt<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">title</font></b><font color="#990000">(</font><font color="#FF0000">'Error RMS error of first-order and high-order networks'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">ylabel</font></b><font color="#990000">(</font><font color="#FF0000">'RMS ERROR'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">xlabel</font></b><font color="#990000">(</font><font color="#FF0000">"EPOCHS"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">def</font></b> <b><font color="#000000">moregraph2</font></b><font color="#990000">(</font>plt<font color="#990000">):</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">title</font></b><font color="#990000">(</font><font color="#FF0000">'Classification error of first-order and high-order networks'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">ylabel</font></b><font color="#990000">(</font><font color="#FF0000">'ERROR'</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt<font color="#990000">.</font><b><font color="#000000">xlabel</font></b><font color="#990000">(</font><font color="#FF0000">"EPOCHS"</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;sim <font color="#990000">=</font> <b><font color="#000000">Simulation</font></b><font color="#990000">(</font>nbr_epoch<font color="#990000">,</font> width<font color="#990000">,</font> data<font color="#990000">,</font> nbr_network<font color="#990000">,</font> <font color="#990000">[</font>FoN<font color="#990000">,</font> SoN<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;sim<font color="#990000">.</font><b><font color="#000000">dgraph</font></b><font color="#990000">([</font><font color="#FF0000">'FoN_rms'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms_input'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms_hidden'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms_output'</font><font color="#990000">,</font> <font color="#FF0000">'FoN_err'</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">'SoN_err_input'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_err_hidden'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_err_output'</font><font color="#990000">],</font> <font color="#990000">[</font>Simulation<font color="#990000">.</font>DISCRETIZE<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;sim<font color="#990000">.</font><b><font color="#000000">launch</font></b><font color="#990000">(</font>nbr_try<font color="#990000">,</font> step_propagation<font color="#990000">,</font> step_statictics<font color="#990000">,</font> step_learn<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;sim<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>point<font color="#990000">,</font> <font color="#FF0000">'FoN_rms'</font><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">'FoN_rms'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms_input'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms_hidden'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_rms_output'</font><font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font><font color="#FF0000">"FoN"</font> <font color="#990000">,</font> <font color="#FF0000">"SoN"</font><font color="#990000">,</font> <font color="#FF0000">"SoN input layer"</font><font color="#990000">,</font> <font color="#FF0000">"SoN hidden layer"</font><font color="#990000">,</font> <font color="#FF0000">"SoN output layer"</font><font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font><font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">2</font> <font color="#990000">,</font> <font color="#993399">2</font> <font color="#990000">],</font> moregraph1<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;sim<font color="#990000">.</font><b><font color="#000000">plot</font></b><font color="#990000">(</font>point<font color="#990000">,</font> <font color="#FF0000">'FoN_rms'</font><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">'FoN_err'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_err_input'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_err_hidden'</font><font color="#990000">,</font> <font color="#FF0000">'SoN_err_output'</font><font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font><font color="#FF0000">"FoN ( winner take all )"</font> <font color="#990000">,</font> <font color="#FF0000">"SoN input layer ( x &gt; 0.5 =&gt; activation )"</font><font color="#990000">,</font> <font color="#FF0000">"SoN hidden layer ( | x - o | &lt;= 0.3 )"</font><font color="#990000">,</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">"SoN output layer ( winner take all )"</font><font color="#990000">],</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#990000">[</font><font color="#993399">3</font><font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">,</font> <font color="#993399">2</font> <font color="#990000">,</font> <font color="#993399">2</font> <font color="#990000">],</font> moregraph2<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;sim<font color="#990000">.</font><b><font color="#000000">custom_plot</font></b><font color="#990000">([</font>Simulation<font color="#990000">.</font>DISCRETIZE<font color="#990000">,</font> Simulation<font color="#990000">.</font>PROTOTYPE<font color="#990000">])</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#Representations hidden</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">graph_networkhidden</font></b><font color="#990000">(</font>sim<font color="#990000">.</font>networks<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">][</font><font color="#FF0000">'FoN'</font><font color="#990000">],</font> Hwidth<font color="#990000">,</font> <font color="#993399">151</font><font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<i><font color="#9A1900">#Representations</font></i><br/>
&nbsp;&nbsp;&nbsp;&nbsp;on <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;hn <font color="#990000">=</font> <font color="#990000">[]</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#0000FF">for</font></b> net <b><font color="#0000FF">in</font></b> sim<font color="#990000">.</font>networks<font color="#990000">:</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>net<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>outputNeurons<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hn<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font>net<font color="#990000">[</font><font color="#FF0000">'FoN'</font><font color="#990000">].</font>hiddenNeurons<font color="#990000">)</font><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#000000">graph_network</font></b><font color="#990000">(</font>on<font color="#990000">,</font> hn<font color="#990000">,</font> width<font color="#990000">)</font><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
</tt><br/>
</body>
